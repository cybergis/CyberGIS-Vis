{"version":3,"file":"leaflet-lasso.umd.min.js","sources":["../node_modules/tslib/tslib.es6.js","../src/lasso-polygon.ts","../node_modules/terraformer/terraformer.js","../node_modules/circle-to-polygon/index.js","../src/calc.ts","../node_modules/style-inject/dist/style-inject.es.js","../src/lasso-handler.ts","../src/lasso-control.ts","../src/index.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) if (e.indexOf(p[i]) < 0)\r\n            t[p[i]] = s[p[i]];\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","import L from 'leaflet';\n\nexport class LassoPolygon extends L.Layer {\n    readonly polyline: L.Polyline;\n    readonly polygon: L.Polygon;\n\n    constructor(latlngs: L.LatLngExpression[], options?: L.PolylineOptions) {\n        super();\n\n        this.polyline = L.polyline(latlngs, options);\n        this.polygon = L.polygon(latlngs, { ...options, weight: 0 });\n    }\n\n    onAdd(map: L.Map): this {\n        this.polyline.addTo(map);\n        this.polygon.addTo(map);\n\n        return this;\n    }\n\n    onRemove(): this {\n        this.polyline.remove();\n        this.polygon.remove();\n\n        return this;\n    }\n\n    addLatLng(latlng: L.LatLngExpression): this {\n        this.polyline.addLatLng(latlng);\n        this.polygon.addLatLng(latlng);\n\n        return this;\n    }\n\n    getLatLngs(): L.LatLng[] {\n        return this.polygon.getLatLngs()[0] as L.LatLng[];\n    }\n\n    toGeoJSON(): GeoJSON.Feature<GeoJSON.Polygon> {\n        return this.polygon.toGeoJSON() as GeoJSON.Feature<GeoJSON.Polygon>;\n    }\n}","(function (root, factory) {\n\n  // Node.\n  if(typeof module === 'object' && typeof module.exports === 'object') {\n    exports = module.exports = factory();\n  }\n\n  // Browser Global.\n  if(typeof window === \"object\") {\n    root.Terraformer = factory();\n  }\n\n}(this, function(){\n  var exports = {},\n      EarthRadius = 6378137,\n      DegreesPerRadian = 57.295779513082320,\n      RadiansPerDegree =  0.017453292519943,\n      MercatorCRS = {\n        \"type\": \"link\",\n        \"properties\": {\n          \"href\": \"http://spatialreference.org/ref/sr-org/6928/ogcwkt/\",\n          \"type\": \"ogcwkt\"\n        }\n      },\n      GeographicCRS = {\n        \"type\": \"link\",\n        \"properties\": {\n          \"href\": \"http://spatialreference.org/ref/epsg/4326/ogcwkt/\",\n          \"type\": \"ogcwkt\"\n        }\n      };\n\n  /*\n  Internal: isArray function\n  */\n  function isArray(obj) {\n    return Object.prototype.toString.call(obj) === \"[object Array]\";\n  }\n\n  /*\n  Internal: safe warning\n  */\n  function warn() {\n    var args = Array.prototype.slice.apply(arguments);\n\n    if (typeof console !== undefined && console.warn) {\n      console.warn.apply(console, args);\n    }\n  }\n\n  /*\n  Internal: Extend one object with another.\n  */\n  function extend(destination, source) {\n    for (var k in source) {\n      if (source.hasOwnProperty(k)) {\n        destination[k] = source[k];\n      }\n    }\n    return destination;\n  }\n\n  /*\n  Public: Calculate an bounding box for a geojson object\n  */\n  function calculateBounds (geojson) {\n    if(geojson.type){\n      switch (geojson.type) {\n        case 'Point':\n          return [ geojson.coordinates[0], geojson.coordinates[1], geojson.coordinates[0], geojson.coordinates[1]];\n\n        case 'MultiPoint':\n          return calculateBoundsFromArray(geojson.coordinates);\n\n        case 'LineString':\n          return calculateBoundsFromArray(geojson.coordinates);\n\n        case 'MultiLineString':\n          return calculateBoundsFromNestedArrays(geojson.coordinates);\n\n        case 'Polygon':\n          return calculateBoundsFromNestedArrays(geojson.coordinates);\n\n        case 'MultiPolygon':\n          return calculateBoundsFromNestedArrayOfArrays(geojson.coordinates);\n\n        case 'Feature':\n          return geojson.geometry? calculateBounds(geojson.geometry) : null;\n\n        case 'FeatureCollection':\n          return calculateBoundsForFeatureCollection(geojson);\n\n        case 'GeometryCollection':\n          return calculateBoundsForGeometryCollection(geojson);\n\n        default:\n          throw new Error(\"Unknown type: \" + geojson.type);\n      }\n    }\n    return null;\n  }\n\n  /*\n  Internal: Calculate an bounding box from an nested array of positions\n  [\n    [\n      [ [lng, lat],[lng, lat],[lng, lat] ]\n    ]\n    [\n      [lng, lat],[lng, lat],[lng, lat]\n    ]\n    [\n      [lng, lat],[lng, lat],[lng, lat]\n    ]\n  ]\n  */\n  function calculateBoundsFromNestedArrays (array) {\n    var x1 = null, x2 = null, y1 = null, y2 = null;\n\n    for (var i = 0; i < array.length; i++) {\n      var inner = array[i];\n\n      for (var j = 0; j < inner.length; j++) {\n        var lonlat = inner[j];\n\n        var lon = lonlat[0];\n        var lat = lonlat[1];\n\n        if (x1 === null) {\n          x1 = lon;\n        } else if (lon < x1) {\n          x1 = lon;\n        }\n\n        if (x2 === null) {\n          x2 = lon;\n        } else if (lon > x2) {\n          x2 = lon;\n        }\n\n        if (y1 === null) {\n          y1 = lat;\n        } else if (lat < y1) {\n          y1 = lat;\n        }\n\n        if (y2 === null) {\n          y2 = lat;\n        } else if (lat > y2) {\n          y2 = lat;\n        }\n      }\n    }\n\n    return [x1, y1, x2, y2 ];\n  }\n\n  /*\n  Internal: Calculate a bounding box from an array of arrays of arrays\n  [\n    [ [lng, lat],[lng, lat],[lng, lat] ]\n    [ [lng, lat],[lng, lat],[lng, lat] ]\n    [ [lng, lat],[lng, lat],[lng, lat] ]\n  ]\n  */\n  function calculateBoundsFromNestedArrayOfArrays (array) {\n    var x1 = null, x2 = null, y1 = null, y2 = null;\n\n    for (var i = 0; i < array.length; i++) {\n      var inner = array[i];\n\n      for (var j = 0; j < inner.length; j++) {\n        var innerinner = inner[j];\n        for (var k = 0; k < innerinner.length; k++) {\n          var lonlat = innerinner[k];\n\n          var lon = lonlat[0];\n          var lat = lonlat[1];\n\n          if (x1 === null) {\n            x1 = lon;\n          } else if (lon < x1) {\n            x1 = lon;\n          }\n\n          if (x2 === null) {\n            x2 = lon;\n          } else if (lon > x2) {\n            x2 = lon;\n          }\n\n          if (y1 === null) {\n            y1 = lat;\n          } else if (lat < y1) {\n            y1 = lat;\n          }\n\n          if (y2 === null) {\n            y2 = lat;\n          } else if (lat > y2) {\n            y2 = lat;\n          }\n        }\n      }\n    }\n\n    return [x1, y1, x2, y2];\n  }\n\n  /*\n  Internal: Calculate a bounding box from an array of positions\n  [\n    [lng, lat],[lng, lat],[lng, lat]\n  ]\n  */\n  function calculateBoundsFromArray (array) {\n    var x1 = null, x2 = null, y1 = null, y2 = null;\n\n    for (var i = 0; i < array.length; i++) {\n      var lonlat = array[i];\n      var lon = lonlat[0];\n      var lat = lonlat[1];\n\n      if (x1 === null) {\n        x1 = lon;\n      } else if (lon < x1) {\n        x1 = lon;\n      }\n\n      if (x2 === null) {\n        x2 = lon;\n      } else if (lon > x2) {\n        x2 = lon;\n      }\n\n      if (y1 === null) {\n        y1 = lat;\n      } else if (lat < y1) {\n        y1 = lat;\n      }\n\n      if (y2 === null) {\n        y2 = lat;\n      } else if (lat > y2) {\n        y2 = lat;\n      }\n    }\n\n    return [x1, y1, x2, y2 ];\n  }\n\n  /*\n  Internal: Calculate an bounding box for a feature collection\n  */\n  function calculateBoundsForFeatureCollection(featureCollection){\n    var extents = [], extent;\n    for (var i = featureCollection.features.length - 1; i >= 0; i--) {\n      extent = calculateBounds(featureCollection.features[i].geometry);\n      extents.push([extent[0],extent[1]]);\n      extents.push([extent[2],extent[3]]);\n    }\n\n    return calculateBoundsFromArray(extents);\n  }\n\n  /*\n  Internal: Calculate an bounding box for a geometry collection\n  */\n  function calculateBoundsForGeometryCollection(geometryCollection){\n    var extents = [], extent;\n\n    for (var i = geometryCollection.geometries.length - 1; i >= 0; i--) {\n      extent = calculateBounds(geometryCollection.geometries[i]);\n      extents.push([extent[0],extent[1]]);\n      extents.push([extent[2],extent[3]]);\n    }\n\n    return calculateBoundsFromArray(extents);\n  }\n\n  function calculateEnvelope(geojson){\n    var bounds = calculateBounds(geojson);\n    return {\n      x: bounds[0],\n      y: bounds[1],\n      w: Math.abs(bounds[0] - bounds[2]),\n      h: Math.abs(bounds[1] - bounds[3])\n    };\n  }\n\n  /*\n  Internal: Convert radians to degrees. Used by spatial reference converters.\n  */\n  function radToDeg(rad) {\n    return rad * DegreesPerRadian;\n  }\n\n  /*\n  Internal: Convert degrees to radians. Used by spatial reference converters.\n  */\n  function degToRad(deg) {\n    return deg * RadiansPerDegree;\n  }\n\n  /*\n  Internal: Loop over each array in a geojson object and apply a function to it. Used by spatial reference converters.\n  */\n  function eachPosition(coordinates, func) {\n    for (var i = 0; i < coordinates.length; i++) {\n      // we found a number so lets convert this pair\n      if(typeof coordinates[i][0] === \"number\"){\n        coordinates[i] = func(coordinates[i]);\n      }\n      // we found an coordinates array it again and run THIS function against it\n      if(typeof coordinates[i] === \"object\"){\n        coordinates[i] = eachPosition(coordinates[i], func);\n      }\n    }\n    return coordinates;\n  }\n\n  /*\n  Public: Convert a GeoJSON Position object to Geographic (4326)\n  */\n  function positionToGeographic(position) {\n    var x = position[0];\n    var y = position[1];\n    return [radToDeg(x / EarthRadius) - (Math.floor((radToDeg(x / EarthRadius) + 180) / 360) * 360), radToDeg((Math.PI / 2) - (2 * Math.atan(Math.exp(-1.0 * y / EarthRadius))))];\n  }\n\n  /*\n  Public: Convert a GeoJSON Position object to Web Mercator (102100)\n  */\n  function positionToMercator(position) {\n    var lng = position[0];\n    var lat = Math.max(Math.min(position[1], 89.99999), -89.99999);\n    return [degToRad(lng) * EarthRadius, EarthRadius/2.0 * Math.log( (1.0 + Math.sin(degToRad(lat))) / (1.0 - Math.sin(degToRad(lat))) )];\n  }\n\n  /*\n  Public: Apply a function agaist all positions in a geojson object. Used by spatial reference converters.\n  */\n  function applyConverter(geojson, converter, noCrs){\n    if(geojson.type === \"Point\") {\n      geojson.coordinates = converter(geojson.coordinates);\n    } else if(geojson.type === \"Feature\") {\n      geojson.geometry = applyConverter(geojson.geometry, converter, true);\n    } else if(geojson.type === \"FeatureCollection\") {\n      for (var f = 0; f < geojson.features.length; f++) {\n        geojson.features[f] = applyConverter(geojson.features[f], converter, true);\n      }\n    } else if(geojson.type === \"GeometryCollection\") {\n      for (var g = 0; g < geojson.geometries.length; g++) {\n        geojson.geometries[g] = applyConverter(geojson.geometries[g], converter, true);\n      }\n    } else {\n      geojson.coordinates = eachPosition(geojson.coordinates, converter);\n    }\n\n    if(!noCrs){\n      if(converter === positionToMercator){\n        geojson.crs = MercatorCRS;\n      }\n    }\n\n    if(converter === positionToGeographic){\n      delete geojson.crs;\n    }\n\n    return geojson;\n  }\n\n  /*\n  Public: Convert a GeoJSON object to ESRI Web Mercator (102100)\n  */\n  function toMercator(geojson) {\n    return applyConverter(geojson, positionToMercator);\n  }\n\n  /*\n  Convert a GeoJSON object to Geographic coordinates (WSG84, 4326)\n  */\n  function toGeographic(geojson) {\n    return applyConverter(geojson, positionToGeographic);\n  }\n\n\n  /*\n  Internal: -1,0,1 comparison function\n  */\n  function cmp(a, b) {\n    if(a < b) {\n      return -1;\n    } else if(a > b) {\n      return 1;\n    } else {\n      return 0;\n    }\n  }\n\n  /*\n  Internal: used for sorting\n  */\n  function compSort(p1, p2) {\n    if (p1[0] > p2[0]) {\n      return -1;\n    } else if (p1[0] < p2[0]) {\n      return 1;\n    } else if (p1[1] > p2[1]) {\n      return -1;\n    } else if (p1[1] < p2[1]) {\n      return 1;\n    } else {\n      return 0;\n    }\n  }\n\n\n  /*\n  Internal: used to determine turn\n  */\n  function turn(p, q, r) {\n    // Returns -1, 0, 1 if p,q,r forms a right, straight, or left turn.\n    return cmp((q[0] - p[0]) * (r[1] - p[1]) - (r[0] - p[0]) * (q[1] - p[1]), 0);\n  }\n\n  /*\n  Internal: used to determine euclidean distance between two points\n  */\n  function euclideanDistance(p, q) {\n    // Returns the squared Euclidean distance between p and q.\n    var dx = q[0] - p[0];\n    var dy = q[1] - p[1];\n\n    return dx * dx + dy * dy;\n  }\n\n  function nextHullPoint(points, p) {\n    // Returns the next point on the convex hull in CCW from p.\n    var q = p;\n    for(var r in points) {\n      var t = turn(p, q, points[r]);\n      if(t === -1 || t === 0 && euclideanDistance(p, points[r]) > euclideanDistance(p, q)) {\n        q = points[r];\n      }\n    }\n    return q;\n  }\n\n  function convexHull(points) {\n    // implementation of the Jarvis March algorithm\n    // adapted from http://tixxit.wordpress.com/2009/12/09/jarvis-march/\n\n    if(points.length === 0) {\n      return [];\n    } else if(points.length === 1) {\n      return points;\n    }\n\n    // Returns the points on the convex hull of points in CCW order.\n    var hull = [points.sort(compSort)[0]];\n\n    for(var p = 0; p < hull.length; p++) {\n      var q = nextHullPoint(points, hull[p]);\n\n      if(q !== hull[0]) {\n        hull.push(q);\n      }\n    }\n\n    return hull;\n  }\n\n  function isConvex(points) {\n    var ltz;\n\n    for (var i = 0; i < points.length - 3; i++) {\n      var p1 = points[i];\n      var p2 = points[i + 1];\n      var p3 = points[i + 2];\n      var v = [p2[0] - p1[0], p2[1] - p1[1]];\n\n      // p3.x * v.y - p3.y * v.x + v.x * p1.y - v.y * p1.x\n      var res = p3[0] * v[1] - p3[1] * v[0] + v[0] * p1[1] - v[1] * p1[0];\n\n      if (i === 0) {\n        if (res < 0) {\n          ltz = true;\n        } else {\n          ltz = false;\n        }\n      } else {\n        if (ltz && (res > 0) || !ltz && (res < 0)) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  }\n\n  function coordinatesContainPoint(coordinates, point) {\n    var contains = false;\n    for(var i = -1, l = coordinates.length, j = l - 1; ++i < l; j = i) {\n      if (((coordinates[i][1] <= point[1] && point[1] < coordinates[j][1]) ||\n           (coordinates[j][1] <= point[1] && point[1] < coordinates[i][1])) &&\n          (point[0] < (coordinates[j][0] - coordinates[i][0]) * (point[1] - coordinates[i][1]) / (coordinates[j][1] - coordinates[i][1]) + coordinates[i][0])) {\n        contains = !contains;\n      }\n    }\n    return contains;\n  }\n\n  function polygonContainsPoint(polygon, point) {\n    if (polygon && polygon.length) {\n      if (polygon.length === 1) { // polygon with no holes\n        return coordinatesContainPoint(polygon[0], point);\n      } else { // polygon with holes\n        if (coordinatesContainPoint(polygon[0], point)) {\n          for (var i = 1; i < polygon.length; i++) {\n            if (coordinatesContainPoint(polygon[i], point)) {\n              return false; // found in hole\n            }\n          }\n\n          return true;\n        } else {\n          return false;\n        }\n      }\n    } else {\n      return false;\n    }\n  }\n\n  function edgeIntersectsEdge(a1, a2, b1, b2) {\n    var ua_t = (b2[0] - b1[0]) * (a1[1] - b1[1]) - (b2[1] - b1[1]) * (a1[0] - b1[0]);\n    var ub_t = (a2[0] - a1[0]) * (a1[1] - b1[1]) - (a2[1] - a1[1]) * (a1[0] - b1[0]);\n    var u_b  = (b2[1] - b1[1]) * (a2[0] - a1[0]) - (b2[0] - b1[0]) * (a2[1] - a1[1]);\n\n    if ( u_b !== 0 ) {\n      var ua = ua_t / u_b;\n      var ub = ub_t / u_b;\n\n      if ( 0 <= ua && ua <= 1 && 0 <= ub && ub <= 1 ) {\n        return true;\n      }\n    }\n\n    return false;\n  }\n\n  function isNumber(n) {\n    return !isNaN(parseFloat(n)) && isFinite(n);\n  }\n\n  function arraysIntersectArrays(a, b) {\n    if (isNumber(a[0][0])) {\n      if (isNumber(b[0][0])) {\n        for (var i = 0; i < a.length - 1; i++) {\n          for (var j = 0; j < b.length - 1; j++) {\n            if (edgeIntersectsEdge(a[i], a[i + 1], b[j], b[j + 1])) {\n              return true;\n            }\n          }\n        }\n      } else {\n        for (var k = 0; k < b.length; k++) {\n          if (arraysIntersectArrays(a, b[k])) {\n            return true;\n          }\n        }\n      }\n    } else {\n      for (var l = 0; l < a.length; l++) {\n        if (arraysIntersectArrays(a[l], b)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  /*\n  Internal: Returns a copy of coordinates for s closed polygon\n  */\n  function closedPolygon(coordinates) {\n    var outer = [ ];\n\n    for (var i = 0; i < coordinates.length; i++) {\n      var inner = coordinates[i].slice();\n      if (pointsEqual(inner[0], inner[inner.length - 1]) === false) {\n        inner.push(inner[0]);\n      }\n\n      outer.push(inner);\n    }\n\n    return outer;\n  }\n\n  function pointsEqual(a, b) {\n    for (var i = 0; i < a.length; i++) {\n\n      if (a[i] !== b[i]) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n\n  function coordinatesEqual(a, b) {\n    if (a.length !== b.length) {\n      return false;\n    }\n\n    var na = a.slice().sort(compSort);\n    var nb = b.slice().sort(compSort);\n\n    for (var i = 0; i < na.length; i++) {\n      if (na[i].length !== nb[i].length) {\n        return false;\n      }\n      for (var j = 0; j < na.length; j++) {\n        if (na[i][j] !== nb[i][j]) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  }\n\n  /*\n  Internal: An array of variables that will be excluded form JSON objects.\n  */\n  var excludeFromJSON = [\"length\"];\n\n  /*\n  Internal: Base GeoJSON Primitive\n  */\n  function Primitive(geojson){\n    if(geojson){\n      switch (geojson.type) {\n      case 'Point':\n        return new Point(geojson);\n\n      case 'MultiPoint':\n        return new MultiPoint(geojson);\n\n      case 'LineString':\n        return new LineString(geojson);\n\n      case 'MultiLineString':\n        return new MultiLineString(geojson);\n\n      case 'Polygon':\n        return new Polygon(geojson);\n\n      case 'MultiPolygon':\n        return new MultiPolygon(geojson);\n\n      case 'Feature':\n        return new Feature(geojson);\n\n      case 'FeatureCollection':\n        return new FeatureCollection(geojson);\n\n      case 'GeometryCollection':\n        return new GeometryCollection(geojson);\n\n      default:\n        throw new Error(\"Unknown type: \" + geojson.type);\n      }\n    }\n  }\n\n  Primitive.prototype.toMercator = function(){\n    return toMercator(this);\n  };\n\n  Primitive.prototype.toGeographic = function(){\n    return toGeographic(this);\n  };\n\n  Primitive.prototype.envelope = function(){\n    return calculateEnvelope(this);\n  };\n\n  Primitive.prototype.bbox = function(){\n    return calculateBounds(this);\n  };\n\n  Primitive.prototype.convexHull = function(){\n    var coordinates = [ ], i, j;\n    if (this.type === 'Point') {\n      return null;\n    } else if (this.type === 'LineString' || this.type === 'MultiPoint') {\n      if (this.coordinates && this.coordinates.length >= 3) {\n        coordinates = this.coordinates;\n      } else {\n        return null;\n      }\n    } else if (this.type === 'Polygon' || this.type === 'MultiLineString') {\n      if (this.coordinates && this.coordinates.length > 0) {\n        for (i = 0; i < this.coordinates.length; i++) {\n          coordinates = coordinates.concat(this.coordinates[i]);\n        }\n        if(coordinates.length < 3){\n          return null;\n        }\n      } else {\n        return null;\n      }\n    } else if (this.type === 'MultiPolygon') {\n      if (this.coordinates && this.coordinates.length > 0) {\n        for (i = 0; i < this.coordinates.length; i++) {\n          for (j = 0; j < this.coordinates[i].length; j++) {\n            coordinates = coordinates.concat(this.coordinates[i][j]);\n          }\n        }\n        if(coordinates.length < 3){\n          return null;\n        }\n      } else {\n        return null;\n      }\n    } else if(this.type === \"Feature\"){\n      var primitive = new Primitive(this.geometry);\n      return primitive.convexHull();\n    }\n\n    return new Polygon({\n      type: 'Polygon',\n      coordinates: closedPolygon([convexHull(coordinates)])\n    });\n  };\n\n  Primitive.prototype.toJSON = function(){\n    var obj = {};\n    for (var key in this) {\n      if (this.hasOwnProperty(key) && excludeFromJSON.indexOf(key) === -1) {\n        obj[key] = this[key];\n      }\n    }\n    obj.bbox = calculateBounds(this);\n    return obj;\n  };\n\n  Primitive.prototype.contains = function(primitive){\n    return new Primitive(primitive).within(this);\n  };\n\n  Primitive.prototype.within = function(primitive) {\n    var coordinates, i, contains;\n\n    // if we are passed a feature, use the polygon inside instead\n    if (primitive.type === 'Feature') {\n      primitive = primitive.geometry;\n    }\n\n    // point.within(point) :: equality\n    if (primitive.type === \"Point\") {\n      if (this.type === \"Point\") {\n        return pointsEqual(this.coordinates, primitive.coordinates);\n\n      }\n    }\n\n    // point.within(multilinestring)\n    if (primitive.type === \"MultiLineString\") {\n      if (this.type === \"Point\") {\n        for (i = 0; i < primitive.coordinates.length; i++) {\n          var linestring = { type: \"LineString\", coordinates: primitive.coordinates[i] };\n\n          if (this.within(linestring)) {\n            return true;\n          }\n        }\n      }\n    }\n\n    // point.within(linestring), point.within(multipoint)\n    if (primitive.type === \"LineString\" || primitive.type === \"MultiPoint\") {\n      if (this.type === \"Point\") {\n        for (i = 0; i < primitive.coordinates.length; i++) {\n          if (this.coordinates.length !== primitive.coordinates[i].length) {\n            return false;\n          }\n\n          if (pointsEqual(this.coordinates, primitive.coordinates[i])) {\n            return true;\n          }\n        }\n      }\n    }\n\n    if (primitive.type === \"Polygon\") {\n      // polygon.within(polygon)\n      if (this.type === \"Polygon\") {\n        // check for equal polygons\n        if (primitive.coordinates.length === this.coordinates.length) {\n          for (i = 0; i < this.coordinates.length; i++) {\n            if (coordinatesEqual(this.coordinates[i], primitive.coordinates[i])) {\n              return true;\n            }\n          }\n        }\n\n        if (this.coordinates.length && polygonContainsPoint(primitive.coordinates, this.coordinates[0][0])) {\n          return !arraysIntersectArrays(closedPolygon(this.coordinates), closedPolygon(primitive.coordinates));\n        } else {\n          return false;\n        }\n\n      // point.within(polygon)\n      } else if (this.type === \"Point\") {\n        return polygonContainsPoint(primitive.coordinates, this.coordinates);\n\n      // linestring/multipoint withing polygon\n      } else if (this.type === \"LineString\" || this.type === \"MultiPoint\") {\n        if (!this.coordinates || this.coordinates.length === 0) {\n          return false;\n        }\n\n        for (i = 0; i < this.coordinates.length; i++) {\n          if (polygonContainsPoint(primitive.coordinates, this.coordinates[i]) === false) {\n            return false;\n          }\n        }\n\n        return true;\n\n      // multilinestring.within(polygon)\n      } else if (this.type === \"MultiLineString\") {\n        for (i = 0; i < this.coordinates.length; i++) {\n          var ls = new LineString(this.coordinates[i]);\n\n          if (ls.within(primitive) === false) {\n            contains++;\n            return false;\n          }\n        }\n\n        return true;\n\n      // multipolygon.within(polygon)\n      } else if (this.type === \"MultiPolygon\") {\n        for (i = 0; i < this.coordinates.length; i++) {\n          var p1 = new Primitive({ type: \"Polygon\", coordinates: this.coordinates[i] });\n\n          if (p1.within(primitive) === false) {\n            return false;\n          }\n        }\n\n        return true;\n      }\n\n    }\n\n    if (primitive.type === \"MultiPolygon\") {\n      // point.within(multipolygon)\n      if (this.type === \"Point\") {\n        if (primitive.coordinates.length) {\n          for (i = 0; i < primitive.coordinates.length; i++) {\n            coordinates = primitive.coordinates[i];\n            if (polygonContainsPoint(coordinates, this.coordinates) && arraysIntersectArrays([this.coordinates], primitive.coordinates) === false) {\n              return true;\n            }\n          }\n        }\n\n        return false;\n      // polygon.within(multipolygon)\n      } else if (this.type === \"Polygon\") {\n        for (i = 0; i < this.coordinates.length; i++) {\n          if (primitive.coordinates[i].length === this.coordinates.length) {\n            for (j = 0; j < this.coordinates.length; j++) {\n              if (coordinatesEqual(this.coordinates[j], primitive.coordinates[i][j])) {\n                return true;\n              }\n            }\n          }\n        }\n\n        if (arraysIntersectArrays(this.coordinates, primitive.coordinates) === false) {\n          if (primitive.coordinates.length) {\n            for (i = 0; i < primitive.coordinates.length; i++) {\n              coordinates = primitive.coordinates[i];\n              if (polygonContainsPoint(coordinates, this.coordinates[0][0]) === false) {\n                contains = false;\n              } else {\n                contains = true;\n              }\n            }\n\n            return contains;\n          }\n        }\n\n      // linestring.within(multipolygon), multipoint.within(multipolygon)\n      } else if (this.type === \"LineString\" || this.type === \"MultiPoint\") {\n        for (i = 0; i < primitive.coordinates.length; i++) {\n          var p = { type: \"Polygon\", coordinates: primitive.coordinates[i] };\n\n          if (this.within(p)) {\n            return true;\n          }\n\n          return false;\n        }\n\n      // multilinestring.within(multipolygon)\n      } else if (this.type === \"MultiLineString\") {\n        for (i = 0; i < this.coordinates.length; i++) {\n          var lines = new LineString(this.coordinates[i]);\n\n          if (lines.within(primitive) === false) {\n            return false;\n          }\n        }\n\n        return true;\n\n      // multipolygon.within(multipolygon)\n      } else if (this.type === \"MultiPolygon\") {\n        for (i = 0; i < primitive.coordinates.length; i++) {\n          var mpoly = { type: \"Polygon\", coordinates: primitive.coordinates[i] };\n\n          if (this.within(mpoly) === false) {\n            return false;\n          }\n        }\n\n        return true;\n      }\n    }\n\n    // default to false\n    return false;\n  };\n\n  Primitive.prototype.intersects = function(primitive) {\n    // if we are passed a feature, use the polygon inside instead\n    if (primitive.type === 'Feature') {\n      primitive = primitive.geometry;\n    }\n\n    var p = new Primitive(primitive);\n    if (this.within(primitive) || p.within(this)) {\n      return true;\n    }\n\n\n    if (this.type !== 'Point' && this.type !== 'MultiPoint' &&\n        primitive.type !== 'Point' && primitive.type !== 'MultiPoint') {\n      return arraysIntersectArrays(this.coordinates, primitive.coordinates);\n    } else if (this.type === 'Feature') {\n      // in the case of a Feature, use the internal primitive for intersection\n      var inner = new Primitive(this.geometry);\n      return inner.intersects(primitive);\n    }\n\n    warn(\"Type \" + this.type + \" to \" + primitive.type + \" intersection is not supported by intersects\");\n    return false;\n  };\n\n\n  /*\n  GeoJSON Point Class\n    new Point();\n    new Point(x,y,z,wtf);\n    new Point([x,y,z,wtf]);\n    new Point([x,y]);\n    new Point({\n      type: \"Point\",\n      coordinates: [x,y]\n    });\n  */\n  function Point(input){\n    var args = Array.prototype.slice.call(arguments);\n\n    if(input && input.type === \"Point\" && input.coordinates){\n      extend(this, input);\n    } else if(input && isArray(input)) {\n      this.coordinates = input;\n    } else if(args.length >= 2) {\n      this.coordinates = args;\n    } else {\n      throw \"Terraformer: invalid input for Terraformer.Point\";\n    }\n\n    this.type = \"Point\";\n  }\n\n  Point.prototype = new Primitive();\n  Point.prototype.constructor = Point;\n\n  /*\n  GeoJSON MultiPoint Class\n      new MultiPoint();\n      new MultiPoint([[x,y], [x1,y1]]);\n      new MultiPoint({\n        type: \"MultiPoint\",\n        coordinates: [x,y]\n      });\n  */\n  function MultiPoint(input){\n    if(input && input.type === \"MultiPoint\" && input.coordinates){\n      extend(this, input);\n    } else if(isArray(input)) {\n      this.coordinates = input;\n    } else {\n      throw \"Terraformer: invalid input for Terraformer.MultiPoint\";\n    }\n\n    this.type = \"MultiPoint\";\n  }\n\n  MultiPoint.prototype = new Primitive();\n  MultiPoint.prototype.constructor = MultiPoint;\n  MultiPoint.prototype.forEach = function(func){\n    for (var i = 0; i < this.coordinates.length; i++) {\n      func.apply(this, [this.coordinates[i], i, this.coordinates]);\n    }\n    return this;\n  };\n  MultiPoint.prototype.addPoint = function(point){\n    this.coordinates.push(point);\n    return this;\n  };\n  MultiPoint.prototype.insertPoint = function(point, index){\n    this.coordinates.splice(index, 0, point);\n    return this;\n  };\n  MultiPoint.prototype.removePoint = function(remove){\n    if(typeof remove === \"number\"){\n      this.coordinates.splice(remove, 1);\n    } else {\n      this.coordinates.splice(this.coordinates.indexOf(remove), 1);\n    }\n    return this;\n  };\n  MultiPoint.prototype.get = function(i){\n    return new Point(this.coordinates[i]);\n  };\n\n  /*\n  GeoJSON LineString Class\n      new LineString();\n      new LineString([[x,y], [x1,y1]]);\n      new LineString({\n        type: \"LineString\",\n        coordinates: [x,y]\n      });\n  */\n  function LineString(input){\n    if(input && input.type === \"LineString\" && input.coordinates){\n      extend(this, input);\n    } else if(isArray(input)) {\n      this.coordinates = input;\n    } else {\n      throw \"Terraformer: invalid input for Terraformer.LineString\";\n    }\n\n    this.type = \"LineString\";\n  }\n\n  LineString.prototype = new Primitive();\n  LineString.prototype.constructor = LineString;\n  LineString.prototype.addVertex = function(point){\n    this.coordinates.push(point);\n    return this;\n  };\n  LineString.prototype.insertVertex = function(point, index){\n    this.coordinates.splice(index, 0, point);\n    return this;\n  };\n  LineString.prototype.removeVertex = function(remove){\n    this.coordinates.splice(remove, 1);\n    return this;\n  };\n\n  /*\n  GeoJSON MultiLineString Class\n      new MultiLineString();\n      new MultiLineString([ [[x,y], [x1,y1]], [[x2,y2], [x3,y3]] ]);\n      new MultiLineString({\n        type: \"MultiLineString\",\n        coordinates: [ [[x,y], [x1,y1]], [[x2,y2], [x3,y3]] ]\n      });\n  */\n  function MultiLineString(input){\n    if(input && input.type === \"MultiLineString\" && input.coordinates){\n      extend(this, input);\n    } else if(isArray(input)) {\n      this.coordinates = input;\n    } else {\n      throw \"Terraformer: invalid input for Terraformer.MultiLineString\";\n    }\n\n    this.type = \"MultiLineString\";\n  }\n\n  MultiLineString.prototype = new Primitive();\n  MultiLineString.prototype.constructor = MultiLineString;\n  MultiLineString.prototype.forEach = function(func){\n    for (var i = 0; i < this.coordinates.length; i++) {\n      func.apply(this, [this.coordinates[i], i, this.coordinates ]);\n    }\n  };\n  MultiLineString.prototype.get = function(i){\n    return new LineString(this.coordinates[i]);\n  };\n\n  /*\n  GeoJSON Polygon Class\n      new Polygon();\n      new Polygon([ [[x,y], [x1,y1], [x2,y2]] ]);\n      new Polygon({\n        type: \"Polygon\",\n        coordinates: [ [[x,y], [x1,y1], [x2,y2]] ]\n      });\n  */\n  function Polygon(input){\n    if(input && input.type === \"Polygon\" && input.coordinates){\n      extend(this, input);\n    } else if(isArray(input)) {\n      this.coordinates = input;\n    } else {\n      throw \"Terraformer: invalid input for Terraformer.Polygon\";\n    }\n\n    this.type = \"Polygon\";\n  }\n\n  Polygon.prototype = new Primitive();\n  Polygon.prototype.constructor = Polygon;\n  Polygon.prototype.addVertex = function(point){\n    this.insertVertex(point, this.coordinates[0].length - 1);\n    return this;\n  };\n  Polygon.prototype.insertVertex = function(point, index){\n    this.coordinates[0].splice(index, 0, point);\n    return this;\n  };\n  Polygon.prototype.removeVertex = function(remove){\n    this.coordinates[0].splice(remove, 1);\n    return this;\n  };\n  Polygon.prototype.close = function() {\n    this.coordinates = closedPolygon(this.coordinates);\n  };\n  Polygon.prototype.hasHoles = function() {\n    return this.coordinates.length > 1;\n  };\n  Polygon.prototype.holes = function() {\n    holes = [];\n    if (this.hasHoles()) {\n      for (var i = 1; i < this.coordinates.length; i++) {\n        holes.push(new Polygon([this.coordinates[i]]));\n      }\n    }\n    return holes;\n  };\n\n  /*\n  GeoJSON MultiPolygon Class\n      new MultiPolygon();\n      new MultiPolygon([ [ [[x,y], [x1,y1]], [[x2,y2], [x3,y3]] ] ]);\n      new MultiPolygon({\n        type: \"MultiPolygon\",\n        coordinates: [ [ [[x,y], [x1,y1]], [[x2,y2], [x3,y3]] ] ]\n      });\n  */\n  function MultiPolygon(input){\n    if(input && input.type === \"MultiPolygon\" && input.coordinates){\n      extend(this, input);\n    } else if(isArray(input)) {\n      this.coordinates = input;\n    } else {\n      throw \"Terraformer: invalid input for Terraformer.MultiPolygon\";\n    }\n\n    this.type = \"MultiPolygon\";\n  }\n\n  MultiPolygon.prototype = new Primitive();\n  MultiPolygon.prototype.constructor = MultiPolygon;\n  MultiPolygon.prototype.forEach = function(func){\n    for (var i = 0; i < this.coordinates.length; i++) {\n      func.apply(this, [this.coordinates[i], i, this.coordinates ]);\n    }\n  };\n  MultiPolygon.prototype.get = function(i){\n    return new Polygon(this.coordinates[i]);\n  };\n  MultiPolygon.prototype.close = function(){\n    var outer = [];\n    this.forEach(function(polygon){\n      outer.push(closedPolygon(polygon));\n    });\n    this.coordinates = outer;\n    return this;\n  };\n\n  /*\n  GeoJSON Feature Class\n      new Feature();\n      new Feature({\n        type: \"Feature\",\n        geometry: {\n          type: \"Polygon\",\n          coordinates: [ [ [[x,y], [x1,y1]], [[x2,y2], [x3,y3]] ] ]\n        }\n      });\n      new Feature({\n        type: \"Polygon\",\n        coordinates: [ [ [[x,y], [x1,y1]], [[x2,y2], [x3,y3]] ] ]\n      });\n  */\n  function Feature(input){\n    if(input && input.type === \"Feature\"){\n      extend(this, input);\n    } else if(input && input.type && input.coordinates) {\n      this.geometry = input;\n    } else {\n      throw \"Terraformer: invalid input for Terraformer.Feature\";\n    }\n\n    this.type = \"Feature\";\n  }\n\n  Feature.prototype = new Primitive();\n  Feature.prototype.constructor = Feature;\n\n  /*\n  GeoJSON FeatureCollection Class\n      new FeatureCollection();\n      new FeatureCollection([feature, feature1]);\n      new FeatureCollection({\n        type: \"FeatureCollection\",\n        coordinates: [feature, feature1]\n      });\n  */\n  function FeatureCollection(input){\n    if(input && input.type === \"FeatureCollection\" && input.features){\n      extend(this, input);\n    } else if(isArray(input)) {\n      this.features = input;\n    } else {\n      throw \"Terraformer: invalid input for Terraformer.FeatureCollection\";\n    }\n\n    this.type = \"FeatureCollection\";\n  }\n\n  FeatureCollection.prototype = new Primitive();\n  FeatureCollection.prototype.constructor = FeatureCollection;\n  FeatureCollection.prototype.forEach = function(func){\n    for (var i = 0; i < this.features.length; i++) {\n      func.apply(this, [this.features[i], i, this.features]);\n    }\n  };\n  FeatureCollection.prototype.get = function(id){\n    var found;\n    this.forEach(function(feature){\n      if(feature.id === id){\n        found = feature;\n      }\n    });\n    return new Feature(found);\n  };\n\n  /*\n  GeoJSON GeometryCollection Class\n      new GeometryCollection();\n      new GeometryCollection([geometry, geometry1]);\n      new GeometryCollection({\n        type: \"GeometryCollection\",\n        coordinates: [geometry, geometry1]\n      });\n  */\n  function GeometryCollection(input){\n    if(input && input.type === \"GeometryCollection\" && input.geometries){\n      extend(this, input);\n    } else if(isArray(input)) {\n      this.geometries = input;\n    } else if(input.coordinates && input.type){\n      this.type = \"GeometryCollection\";\n      this.geometries = [input];\n    } else {\n      throw \"Terraformer: invalid input for Terraformer.GeometryCollection\";\n    }\n\n    this.type = \"GeometryCollection\";\n  }\n\n  GeometryCollection.prototype = new Primitive();\n  GeometryCollection.prototype.constructor = GeometryCollection;\n  GeometryCollection.prototype.forEach = function(func){\n    for (var i = 0; i < this.geometries.length; i++) {\n      func.apply(this, [this.geometries[i], i, this.geometries]);\n    }\n  };\n  GeometryCollection.prototype.get = function(i){\n    return new Primitive(this.geometries[i]);\n  };\n\n  function createCircle(center, radius, interpolate){\n    var mercatorPosition = positionToMercator(center);\n    var steps = interpolate || 64;\n    var polygon = {\n      type: \"Polygon\",\n      coordinates: [[]]\n    };\n    for(var i=1; i<=steps; i++) {\n      var radians = i * (360/steps) * Math.PI / 180;\n      polygon.coordinates[0].push([mercatorPosition[0] + radius * Math.cos(radians), mercatorPosition[1] + radius * Math.sin(radians)]);\n    }\n    polygon.coordinates = closedPolygon(polygon.coordinates);\n\n    return toGeographic(polygon);\n  }\n\n  function Circle (center, radius, interpolate) {\n    var steps = interpolate || 64;\n    var rad = radius || 250;\n\n    if(!center || center.length < 2 || !rad || !steps) {\n      throw new Error(\"Terraformer: missing parameter for Terraformer.Circle\");\n    }\n\n    extend(this, new Feature({\n      type: \"Feature\",\n      geometry: createCircle(center, rad, steps),\n      properties: {\n        radius: rad,\n        center: center,\n        steps: steps\n      }\n    }));\n  }\n\n  Circle.prototype = new Primitive();\n  Circle.prototype.constructor = Circle;\n  Circle.prototype.recalculate = function(){\n    this.geometry = createCircle(this.properties.center, this.properties.radius, this.properties.steps);\n    return this;\n  };\n  Circle.prototype.center = function(coordinates){\n    if(coordinates){\n      this.properties.center = coordinates;\n      this.recalculate();\n    }\n    return this.properties.center;\n  };\n  Circle.prototype.radius = function(radius){\n    if(radius){\n      this.properties.radius = radius;\n      this.recalculate();\n    }\n    return this.properties.radius;\n  };\n  Circle.prototype.steps = function(steps){\n    if(steps){\n      this.properties.steps = steps;\n      this.recalculate();\n    }\n    return this.properties.steps;\n  };\n\n  Circle.prototype.toJSON = function() {\n    var output = Primitive.prototype.toJSON.call(this);\n    return output;\n  };\n\n  exports.Primitive = Primitive;\n  exports.Point = Point;\n  exports.MultiPoint = MultiPoint;\n  exports.LineString = LineString;\n  exports.MultiLineString = MultiLineString;\n  exports.Polygon = Polygon;\n  exports.MultiPolygon = MultiPolygon;\n  exports.Feature = Feature;\n  exports.FeatureCollection = FeatureCollection;\n  exports.GeometryCollection = GeometryCollection;\n  exports.Circle = Circle;\n\n  exports.toMercator = toMercator;\n  exports.toGeographic = toGeographic;\n\n  exports.Tools = {};\n  exports.Tools.positionToMercator = positionToMercator;\n  exports.Tools.positionToGeographic = positionToGeographic;\n  exports.Tools.applyConverter = applyConverter;\n  exports.Tools.toMercator = toMercator;\n  exports.Tools.toGeographic = toGeographic;\n  exports.Tools.createCircle = createCircle;\n\n  exports.Tools.calculateBounds = calculateBounds;\n  exports.Tools.calculateEnvelope = calculateEnvelope;\n\n  exports.Tools.coordinatesContainPoint = coordinatesContainPoint;\n  exports.Tools.polygonContainsPoint = polygonContainsPoint;\n  exports.Tools.arraysIntersectArrays = arraysIntersectArrays;\n  exports.Tools.coordinatesContainPoint = coordinatesContainPoint;\n  exports.Tools.coordinatesEqual = coordinatesEqual;\n  exports.Tools.convexHull = convexHull;\n  exports.Tools.isConvex = isConvex;\n\n  exports.MercatorCRS = MercatorCRS;\n  exports.GeographicCRS = GeographicCRS;\n\n  return exports;\n}));\n","\"use strict\";\nfunction toRadians(angleInDegrees) {\n  return angleInDegrees * Math.PI / 180;\n}\n\nfunction toDegrees(angleInRadians) {\n  return angleInRadians * 180 / Math.PI;\n}\n\nfunction offset(c1, distance, bearing) {\n  var lat1 = toRadians(c1[1]);\n  var lon1 = toRadians(c1[0]);\n  var dByR = distance / 6378137; // distance divided by 6378137 (radius of the earth) wgs84\n  var lat = Math.asin(\n    Math.sin(lat1) * Math.cos(dByR) +\n    Math.cos(lat1) * Math.sin(dByR) * Math.cos(bearing));\n  var lon = lon1 + Math.atan2(\n      Math.sin(bearing) * Math.sin(dByR) * Math.cos(lat1),\n      Math.cos(dByR) - Math.sin(lat1) * Math.sin(lat));\n  return [toDegrees(lon), toDegrees(lat)];\n}\n\nmodule.exports = function circleToPolygon(center, radius, numberOfSegments) {\n  var n = numberOfSegments ? numberOfSegments : 32;\n  var flatCoordinates = [];\n  var coordinates = [];\n  for (var i = 0; i < n; ++i) {\n    flatCoordinates.push.apply(flatCoordinates, offset(center, radius, 2 * Math.PI * i / n));\n  }\n  flatCoordinates.push(flatCoordinates[0], flatCoordinates[1]);\n\n  for (var i = 0, j = 0; j < flatCoordinates.length; j += 2) {\n    coordinates[i++] = flatCoordinates.slice(j, j + 2);\n  }\n\n  return {\n    type: 'Polygon',\n    coordinates: [coordinates.reverse()]\n  };\n};\n","import L from 'leaflet';\nimport Terraformer from 'terraformer';\nimport circleToPolygon from 'circle-to-polygon';\n\nfunction getCircleMarkerRadius(circleMarker: L.CircleMarker, crs: L.CRS, zoom: number) {\n    const latLng = circleMarker.getLatLng();\n    const point = crs.latLngToPoint(latLng, zoom);\n    const delta = circleMarker.getRadius() / Math.SQRT2;\n    const topLeftPoint = L.point([point.x - delta, point.y - delta]);\n    const topLeftLatLng = crs.pointToLatLng(topLeftPoint, zoom);\n    const radius = crs.distance(latLng, topLeftLatLng);\n    return radius;\n}\n\nfunction circleToGeoJSONGeometry(latLng: L.LatLng, radius: number) {\n    // Terraformer result is incorrect, see https://github.com/Esri/terraformer/issues/321\n    // return new Terraformer.Circle(L.GeoJSON.latLngToCoords(latLng), radius).geometry;\n\n    return circleToPolygon(L.GeoJSON.latLngToCoords(latLng), radius);\n}\n\nexport function getLayersInPolygon(polygon: GeoJSON.Polygon, layers: L.Layer[], options: { zoom?: number, crs?: L.CRS, intersect?: boolean } = {}) {\n    const crs = options.crs || L.CRS.EPSG3857;\n    const polygonGeometry = new Terraformer.Primitive(polygon);\n\n    const selectedLayers = layers.filter(layer => {\n        let layerGeometry: GeoJSON.GeometryObject;\n\n        if (layer instanceof L.Circle) {\n            const latLng = layer.getLatLng();\n            const radius = layer.getRadius();\n            layerGeometry = circleToGeoJSONGeometry(latLng, radius);\n        } else if (layer instanceof L.CircleMarker) {\n            if (options.zoom != undefined) {\n                const latLng = layer.getLatLng();\n                const radius = getCircleMarkerRadius(layer, crs, options.zoom);\n                layerGeometry = circleToGeoJSONGeometry(latLng, radius);\n            } else {\n                console.warn(\"Zoom is required for calculating CircleMarker polygon, falling back to center point only\");\n                layerGeometry = layer.toGeoJSON().geometry;\n            }\n        } else if (layer instanceof L.Marker || layer instanceof L.Polyline) {\n            layerGeometry = layer.toGeoJSON().geometry;\n        } else {\n            return false;\n        }\n\n        return options.intersect && layerGeometry.type !== \"Point\" ?\n            polygonGeometry.intersects(layerGeometry) :\n            polygonGeometry.contains(layerGeometry);\n    });\n    \n    return selectedLayers;\n}","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import L from 'leaflet';\nimport { LassoPolygon } from './lasso-polygon';\nimport { getLayersInPolygon } from './calc';\nimport './lasso-handler.css';\n\nexport interface LassoHandlerOptions {\n    polygon?: L.PolylineOptions,\n    intersect?: boolean;\n}\n\ninterface LassoHandlerFinishedEventData {\n    latLngs: L.LatLng[];\n    layers: L.Layer[];\n}\n\nexport type LassoHandlerFinishedEvent = L.LeafletEvent & LassoHandlerFinishedEventData;\n\nexport const ENABLED_EVENT = 'lasso.enabled';\nexport const DISABLED_EVENT = 'lasso.disabled';\nexport const FINISHED_EVENT = 'lasso.finished';\n\nexport const ACTIVE_CLASS = 'leaflet-lasso-active';\n\nexport class LassoHandler extends L.Handler {\n    options: LassoHandlerOptions = {\n        polygon: {\n            color: '#00C3FF',\n            weight: 2,\n        },\n        intersect: false,\n    };\n\n    private map: L.Map;\n\n    private polygon?: LassoPolygon;\n\n    private onDocumentMouseMoveBound = this.onDocumentMouseMove.bind(this);\n    private onDocumentMouseUpBound = this.onDocumentMouseUp.bind(this);\n\n    constructor(map: L.Map, options: LassoHandlerOptions = {}) {\n        super(map);\n        \n        this.map = map;\n        L.Util.setOptions(this, options);\n    }\n\n    setOptions(options: LassoHandlerOptions) {\n        this.options = { ...this.options, ...options };\n    }\n\n    toggle() {\n        if (this.enabled()) {\n            this.disable();\n        } else {\n            this.enable();\n        }\n    }\n    \n    addHooks() {\n        this.map.getPane('mapPane');\n        this.map.on('mousedown', this.onMapMouseDown, this);\n        \n        const mapContainer = this.map.getContainer();\n        mapContainer.classList.add(ACTIVE_CLASS);\n\n        this.map.dragging.disable();\n        this.map.fire(ENABLED_EVENT);\n    }\n\n    removeHooks() {\n        if (this.polygon) {\n            this.map.removeLayer(this.polygon);\n            this.polygon = undefined;\n        }\n\n        this.map.off('mousedown', this.onMapMouseDown, this);\n        document.removeEventListener('mousemove', this.onDocumentMouseMoveBound);\n        document.removeEventListener('mouseup', this.onDocumentMouseUpBound);\n\n        this.map.getContainer().classList.remove(ACTIVE_CLASS);\n        document.body.classList.remove(ACTIVE_CLASS);\n\n        this.map.dragging.enable();\n        this.map.fire(DISABLED_EVENT);\n    }\n\n    getPolygon() {\n        return this.polygon;\n    }\n\n    private onMapMouseDown(event: L.LeafletEvent) {\n        const event2 = event as L.LeafletMouseEvent;\n\n        // activate lasso only for left mouse button click\n        if (event2.originalEvent.buttons !== 1) {\n            this.disable();\n            return;\n        }\n\n        // skip clicks on controls\n        if ((event2.originalEvent.target as HTMLElement).closest('.leaflet-control-container')) {\n            return;\n        }\n\n        this.polygon = new LassoPolygon([event2.latlng], this.options.polygon).addTo(this.map);\n\n        document.body.classList.add(ACTIVE_CLASS);\n\n        document.addEventListener('mousemove', this.onDocumentMouseMoveBound);\n        document.addEventListener('mouseup', this.onDocumentMouseUpBound);\n    }\n\n    private onDocumentMouseMove(event: Event) {\n        if (!this.polygon) {\n            return;\n        }\n\n        const event2 = event as MouseEvent;\n\n        // keep lasso active only if left mouse button is hold\n        if (event2.buttons !== 1) {\n            console.warn('mouseup event was missed');\n            this.finish();\n            return;\n        }\n\n        this.polygon.addLatLng(this.map.mouseEventToLatLng(event2));\n    }\n\n    private onDocumentMouseUp() {\n        this.finish();\n    }\n\n    private finish() {\n        if (!this.polygon) {\n            return;\n        }\n\n        const polygon = this.polygon.toGeoJSON().geometry;\n        const layers: L.Layer[] = [];\n        this.map.eachLayer(layer => {\n            if (layer === this.polygon || layer === this.polygon!.polyline || layer === this.polygon!.polygon) {\n                return;\n            }\n\n            if (layer instanceof L.Marker || layer instanceof L.Path) {\n                layers.push(layer);\n            } else if (L.MarkerCluster && layer instanceof L.MarkerCluster) {\n                layers.push(...layer.getAllChildMarkers());\n            }\n        });\n\n        const selectedFeatures = getLayersInPolygon(polygon, layers, {\n            zoom: this.map.getZoom(),\n            crs: this.map.options.crs,\n            intersect: this.options.intersect,\n        });\n\n        this.map.fire(FINISHED_EVENT, {\n            latLngs: this.polygon.getLatLngs(),\n            layers: selectedFeatures,\n        } as LassoHandlerFinishedEventData);\n\n        this.disable();\n    }\n}\n","import L from 'leaflet';\nimport { LassoHandler, LassoHandlerOptions } from './lasso-handler';\nimport './lasso-control.css';\n\nexport type LassoControlOptions = LassoHandlerOptions & L.ControlOptions;\n\nexport class LassoControl extends L.Control {\n    options: LassoControlOptions = {\n        position: 'topright',\n    };\n\n    private lasso?: LassoHandler;\n\n    constructor(options: LassoControlOptions = {}) {\n        super();\n\n        L.Util.setOptions(this, options);\n    }\n\n    setOptions(options: LassoControlOptions) {\n        this.options = { ...this.options, ...options };\n        \n        if (this.lasso) {\n            this.lasso.setOptions(this.options);\n        }\n    }\n\n    onAdd(map: L.Map) {\n        this.lasso = new LassoHandler(map, this.options);\n\n        const container = L.DomUtil.create('div', 'leaflet-bar leaflet-control') as HTMLDivElement;\n        const button = L.DomUtil.create('a', 'leaflet-control-lasso', container) as HTMLAnchorElement;\n        button.href = '#';\n        button.title = 'Toggle Lasso';\n        button.setAttribute('role', 'button');\n        button.setAttribute('aria-label', button.title);\n\n        L.DomEvent.addListener(button, 'click', this.toggle, this);\n\n        return container;\n    }\n\n    enabled() {\n        if (!this.lasso) {\n            return false;\n        }\n        return this.lasso.enabled();\n    }\n\n    enable() {\n        if (!this.lasso) {\n            return;\n        }\n        this.lasso.enable();\n    }\n\n    disable() {\n        if (!this.lasso) {\n            return;\n        }\n        this.lasso.disable();\n    }\n\n    toggle() {\n        if (!this.lasso) {\n            return;\n        }\n        this.lasso.toggle();\n    }\n}\n","import L from 'leaflet';\nimport { LassoHandler } from './lasso-handler';\nimport { LassoControl } from './lasso-control';\n\ndeclare module 'leaflet' {\n    type Lasso = LassoHandler;\n    let Lasso: typeof LassoHandler;\n\n    let lasso: (...args: ConstructorParameters<typeof LassoHandler>) => LassoHandler;\n    \n    namespace Control {\n        type Lasso = LassoControl;\n        let Lasso: typeof LassoControl;\n    }\n\n    namespace control {\n        let lasso: (...args: ConstructorParameters<typeof LassoControl>) => LassoControl;\n    }\n}\n\nL.Lasso = LassoHandler;\nL.lasso = (...args: ConstructorParameters<typeof LassoHandler>) => new LassoHandler(...args);\n\nL.Control.Lasso = LassoControl;\nL.control.lasso = (...args: ConstructorParameters<typeof LassoControl>) => new LassoControl(...args);\n\nexport * from './lasso-handler';\nexport * from './lasso-control';"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","latlngs","options","_super","_this","polyline","L","polygon","weight","tslib_1.__extends","LassoPolygon","map","addTo","remove","latlng","addLatLng","getLatLngs","toGeoJSON","Layer","root","factory","exports","EarthRadius","DegreesPerRadian","RadiansPerDegree","MercatorCRS","type","properties","href","isArray","obj","toString","extend","destination","source","k","calculateBounds","geojson","coordinates","calculateBoundsFromArray","calculateBoundsFromNestedArrays","array","x1","x2","y1","y2","inner","j","innerinner","lonlat","lon","lat","calculateBoundsFromNestedArrayOfArrays","geometry","featureCollection","extent","extents","features","push","calculateBoundsForFeatureCollection","geometryCollection","geometries","calculateBoundsForGeometryCollection","Error","calculateEnvelope","bounds","x","y","w","Math","abs","h","radToDeg","rad","degToRad","deg","positionToGeographic","position","floor","PI","atan","exp","positionToMercator","lng","max","min","log","sin","applyConverter","converter","noCrs","f","g","eachPosition","func","crs","toMercator","toGeographic","compSort","p1","p2","turn","q","r","a","euclideanDistance","dx","dy","nextHullPoint","points","convexHull","hull","sort","coordinatesContainPoint","point","contains","l","polygonContainsPoint","edgeIntersectsEdge","a1","a2","b1","b2","ua_t","ub_t","u_b","ua","ub","isNumber","isNaN","parseFloat","isFinite","arraysIntersectArrays","closedPolygon","outer","slice","pointsEqual","coordinatesEqual","na","nb","excludeFromJSON","Primitive","Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Feature","FeatureCollection","GeometryCollection","input","args","createCircle","center","radius","interpolate","mercatorPosition","steps","radians","cos","Circle","envelope","bbox","concat","toJSON","key","indexOf","primitive","within","linestring","mpoly","intersects","undefined","console","warn","forEach","addPoint","insertPoint","index","splice","removePoint","get","addVertex","insertVertex","removeVertex","close","hasHoles","holes","id","found","feature","recalculate","Tools","isConvex","ltz","p3","v","res","GeographicCRS","module","window","Terraformer","toRadians","angleInDegrees","toDegrees","angleInRadians","numberOfSegments","c1","distance","bearing","lat1","lon1","dByR","flatCoordinates","asin","atan2","reverse","circleToGeoJSONGeometry","latLng","circleToPolygon","GeoJSON","latLngToCoords","getLayersInPolygon","layers","CRS","EPSG3857","polygonGeometry","filter","layer","layerGeometry","getLatLng","getRadius","CircleMarker","zoom","circleMarker","latLngToPoint","delta","SQRT2","topLeftPoint","topLeftLatLng","pointToLatLng","getCircleMarkerRadius","Marker","Polyline","intersect","styleInject","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","ACTIVE_CLASS","color","onDocumentMouseMove","bind","onDocumentMouseUp","Util","setOptions","LassoHandler","enabled","disable","enable","getPane","on","onMapMouseDown","getContainer","classList","add","dragging","fire","removeLayer","off","removeEventListener","onDocumentMouseMoveBound","onDocumentMouseUpBound","body","event","event2","originalEvent","buttons","target","closest","addEventListener","finish","mouseEventToLatLng","eachLayer","Path","MarkerCluster","getAllChildMarkers","selectedFeatures","getZoom","latLngs","Handler","LassoControl","lasso","container","DomUtil","button","title","setAttribute","DomEvent","addListener","toggle","Control","Lasso","_i","control"],"mappings":"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"}